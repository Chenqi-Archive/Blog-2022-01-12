前几天在食堂吃早饭时突然意识到，做菜的过程完全就是一种计算：从食品原料出发，经过一系列预先定义的加工流程，最后得到成熟的菜品。步骤之间的依赖关系可以用有向无环图表示。结合之前在编译课后[对寄存器分配问题的思考](https://hchenqi.github.io/#有向无环图上的寄存器分配（一）)，可以重新排列各个步骤的顺序，使得有限的厨房空间能被更高效地利用。

删除![img](https://img1.doubanio.com/view/note/l/H3cyvTVPqT7SmpZYhJsqpw/226180635/x84613619.jpg)

用有向无环图表示(a + b) * (-b)的计算过程

我之所以会产生这个想法，或许受到了最近频繁出现在豆瓣推送中的炸厨房组的影响，又或者是源于微信公众号经常推送的做菜视频，也可能是因为王垠最近发的几条微博都是关于做菜的，我已经记不清了。

这个想法看上去很美妙，但把菜谱转化为程序好像并不容易。我从网上随便找了个菜谱作为例子，下面就来尝试一下。

删除![img](https://img9.doubanio.com/view/note/l/YbZH7XoKDKMQyMRaWvHHUw/226180635/x84612625.jpg)

木须肉（图源百度百科，链接见下）

>【木须肉】（https://baike.baidu.com/item/木须肉/440282?fr=aladdin#2）
1、泡发木耳。提前将木耳泡在温水中直到泡发。
2、将猪里脊肉切成片、木耳去掉根部撕成小块、黄瓜切片、鸡蛋打散、葱姜蒜切末备用。
3、腌肉。往猪里脊肉内加入一勺料酒、一勺玉米淀粉、半个蛋清，然后抓匀腌制十分钟。
4、锅中倒入适量的油，油热后倒入蛋液，小火将鸡蛋炒熟然后盛出备用。
5、锅中再倒入少许油，油热后放入里脊肉快速滑开。
6、待里脊肉颜色变白，放入葱姜蒜煸炒出香味。(肉不需要炒太久，变白即可。炒太久，口感就老了)
7、将木耳放入锅中煸炒均匀后加热2分钟。然后放入1勺盐、2勺生抽调味。
8、将黄瓜放入锅中煸炒均匀。
9、将鸡蛋放入锅中煸炒均匀。然后在出锅前放少许鸡精和香油翻拌均匀即可。

（我本来打算选麻婆豆腐（https://baike.baidu.com/item/麻婆豆腐/30888?fr=aladdin#2_3）作为例子，但觉得有些简单，就换了这个稍微复杂一些的木须肉）

原文中的步骤使用序列表示（步骤1,2,...,9），但经过分析可以发现，有些步骤之间并没有严格的先后关系，比如步骤1泡发木耳、步骤3腌肉、步骤4炒鸡蛋的次序可以任意交换，步骤2中有很多小步骤，也可以拆开作为单独的步骤。整理之后，各个步骤大概呈现下面的依赖关系：

删除![img](https://img2.doubanio.com/view/note/l/ZwWswYnqb1dwVKrJbdgXkA/226180635/x84613411.jpg)

用有向无环图表示木须肉的加工过程

当然，上面的图只是一个大概的示意图，很多细节信息，比如各个原材料的用量、放入的顺序、加工的时间等都没有体现出来。

