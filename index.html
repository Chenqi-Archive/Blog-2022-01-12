<html>

	<head>
		<link rel="icon" href="favicon.jpg" />
		<title>Chenqi's blog</title>
		<style>
			body {
				width: 100%;
				height: fit-content;
				margin: 0px auto;
				font-family: Segoe UI, DengXian;
				font-size: 18px;
				line-height: 1.6;
			}

			@media (min-width:900px) {
				body {
					width: 900px;
				}
			}

			#menu-bar {
				width: 100%;
				height: 30px;
				border: 1px;
				background-color: #d3ee90;
			}

			#button-back {
				width: 50px;
				height: 100%;
				left: 0px;
				top: 0px;
				background-color: #dddddd;
				float: left;
				visibility: hidden;
			}

			#button-menu {
				width: 50px;
				height: 100%;
				right: 0px;
				top: 0px;
				background-color: #dddddd;
				float: right;				
			}

			#title {
				height: 100%;
				left: 50px;
				top: 0px;
				text-align: center;
    			font-weight: bold;
			}
			
			#article-list {
				margin: 5px 0px;
			}
			
			#article-title {
				border: 1px solid #ddd;
				padding: 10px 10px;
				margin-bottom: -1px;
				font-size: 20px;
			}

			#article {
				border: 3px solid #ddd;
			    border-radius: 10px;
			    padding: 20px 50px 100px;
			    margin: 5px 0;
			}

		</style>
	</head>

	<body>
		<div id="menu-bar">
			<div id="button-back" onclick="go_back()">
				<svg style="width:100%;height:100%;fill:none;stroke:black;stroke-width:1">
					<polyline points="20,7 10,15 20,23" />
					<polyline points="10,15 40,15" />
				</svg>
			</div>
			<div id="button-menu" onclick="show_or_hide_article_list()">
				<svg style="width:100%;height:100%;fill:none;stroke:black;stroke-width:1">
					<polyline points="10,10 40,10" />
					<polyline points="10,15 40,15" />
					<polyline points="10,20 40,20" />
				</svg>
			</div>			
			<div id="title">Chenqi's blog</div>
		</div>
		<div id="article-list"></div>
		<div id="article" style="display:none"></div>
		<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
		<script>
			article_list = document.getElementById("article-list");
			article = document.getElementById('article');
			req = new XMLHttpRequest();
			function load_file(file_path, on_success){
				req.onreadystatechange = function () {
					if (req.readyState == 4 /*&& req.status == 200*/) { on_success(req.responseText); }
				};
				req.open('GET', file_path, true);
				req.send();
			}
			function load_article_list(){
				load_file('article list.txt', function(response){
					var articles = response.split('\n');
					for(let i = 0; i < articles.length; i++){
						let article_title = document.createElement('div');
						article_title.id = 'article-title';
						article_title.innerText = articles[i];
						article_title.onclick = function(){load_article(article_title.innerText);};
						article_list.appendChild(article_title);
					}
				});
			}
			function load_article(article_title) {
				load_file('articles/' + article_title + '.md', function(response){
					article.innerHTML = marked(response);
					article.style.display = 'block';					
				});
				article_stack.push(article_title);
				document.getElementById("button-back").style.visibility = 'visible';
				article_list.style.display = 'none';
			}
			function go_back() {
				if(article_stack.length == 0) {throw '';}
				article_stack.pop();
				if(article_stack.length == 0) {
					article_list.style.display = 'block';
					article.style.display = 'none';
					document.getElementById("button-back").style.visibility = 'hidden';
				} else{
					load_article(article_stack.pop());
				}
			}
			function show_or_hide_article_list(){
				if(article_list.style.display == 'none'){
					article_list.style.display = 'block';
				} else {
					article_list.style.display = 'none';
				}
			}
			load_article_list();
			article_stack = [];
		</script>
	</body>
</html>